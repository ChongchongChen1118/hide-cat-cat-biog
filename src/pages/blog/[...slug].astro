---
import { getCollection } from "astro:content";
import PostLayout from "../../layouts/PostLayout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("posts", (p) => !p.data.draft);
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---
<PostLayout frontmatter={post.data}>
  <Content />

<hr />
<div class="small" style="color:var(--muted);margin-bottom:8px;">
  评论（Giscus）
</div>

<style>
  /* 只微调 giscus 在深色背景下的可读性 */
  .giscus-wrap {
    --color-fg-muted: rgba(255,255,255,0.65);
    --color-fg-default: rgba(255,255,255,0.9);
    --color-border-default: rgba(255,255,255,0.15);
  }
</style>

<div class="giscus-wrap">
  <script src="https://giscus.app/client.js"
    data-repo="ChongchongChen1118/hide-cat-cat-biog"
    data-repo-id="R_kgDOQ6otfg"
    data-category="General"              <!-- ✅ 换成你 giscus.app 上选的分类名 -->
    data-category-id="DIC_kwDOQ6otfs4C..."<!-- ✅ 换成你 giscus.app 给的 category-id -->
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="dark"        <!-- ✅ 关键：深色透明主题 -->
    data-lang="zh-CN"
    crossorigin="anonymous"
    async>
  </script>
</div>
